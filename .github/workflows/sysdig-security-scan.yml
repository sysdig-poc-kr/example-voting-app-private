name: Sysdig Security Scan

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    # ë§¤ì¼ ì˜¤ì „ 2ì‹œ (UTC) ì •ê¸° ìŠ¤ìº”
    - cron: '0 2 * * *'

env:
  REGISTRY: ghcr.io
  SYSDIG_SECURE_ENDPOINT: ${{ secrets.SYSDIG_SECURE_ENDPOINT }}
  SYSDIG_SECURE_API_TOKEN: ${{ secrets.SYSDIG_SECURE_API_TOKEN }}

jobs:
  # IaC ë³´ì•ˆ ìŠ¤ìº” (Kubernetes YAML íŒŒì¼ë“¤)
  iac-scan:
    name: Sysdig IaC Security Scan
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run Sysdig IaC Scan
        uses: sysdiglabs/scan-action@v6
        with:
          # IaC ìŠ¤ìº”ì„ ìœ„í•œ ì˜¬ë°”ë¥¸ ì„¤ì •
          image-tag: "k8s-iac-scan"
          sysdig-secure-token: ${{ secrets.SYSDIG_SECURE_API_TOKEN }}
          sysdig-secure-url: ${{ secrets.SYSDIG_SECURE_ENDPOINT }}
          # IaC ìŠ¤ìº”ì—ëŠ” dockerfile-path ëŒ€ì‹  scan path ì‚¬ìš©
          input-type: "iac"
          run-as-user: "root"
          # IaC ìŠ¤ìº” ê¸°ë³¸ ì„¤ì •
          stop-on-failed-policy-eval: false
          stop-on-policy-eval-failure: false
          use-policies: true

      - name: Upload IaC Scan Results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: sysdig-iac-results
          path: |
            sysdig-results.*
            scan-result.json

  # Vote ì„œë¹„ìŠ¤ ë¹Œë“œ ë° ìŠ¤ìº”
  vote-build-scan:
    name: Vote Service - Sysdig Scan
    runs-on: ubuntu-latest
    outputs:
      image: ${{ steps.image.outputs.image }}
      digest: ${{ steps.build.outputs.digest }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Extract metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ github.repository }}/vote
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=sha,prefix={{branch}}-
            type=raw,value=latest,enable={{is_default_branch}}

      - name: Build and push Docker image
        id: build
        uses: docker/build-push-action@v6
        with:
          context: ./vote
          target: final
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          # v6ì˜ ìƒˆë¡œìš´ ê¸°ëŠ¥ë“¤
          provenance: true
          sbom: true
          platforms: linux/amd64,linux/arm64

      - name: Output image
        id: image
        run: |
          echo "image=${{ env.REGISTRY }}/${{ github.repository }}/vote:${{ github.sha }}" >> $GITHUB_OUTPUT

      - name: Run Sysdig Secure Scan
        uses: sysdiglabs/scan-action@v6
        with:
          image-tag: ${{ steps.image.outputs.image }}
          sysdig-secure-token: ${{ secrets.SYSDIG_SECURE_API_TOKEN }}
          sysdig-secure-url: ${{ secrets.SYSDIG_SECURE_ENDPOINT }}
          dockerfile-path: ./vote/Dockerfile
          input-type: "docker-daemon"
          run-as-user: "root"
          # v6 ê¸°ë³¸ ì„¤ì •
          stop-on-failed-policy-eval: false
          stop-on-policy-eval-failure: false
          use-policies: true
          registry-user: ${{ github.actor }}
          registry-password: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload SARIF results
        if: always()
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: sysdig-results.sarif

      - name: Upload Vote Scan Results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: sysdig-vote-results
          path: |
            sysdig-results.*
            scan-result.json

  # Worker ì„œë¹„ìŠ¤ ë¹Œë“œ ë° ìŠ¤ìº”
  worker-build-scan:
    name: Worker Service - Sysdig Scan
    runs-on: ubuntu-latest
    outputs:
      image: ${{ steps.image.outputs.image }}
      digest: ${{ steps.build.outputs.digest }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Extract metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ github.repository }}/worker
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=sha,prefix={{branch}}-
            type=raw,value=latest,enable={{is_default_branch}}

      - name: Build and push Docker image
        id: build
        uses: docker/build-push-action@v6
        with:
          context: ./worker
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          # v6ì˜ ìƒˆë¡œìš´ ê¸°ëŠ¥ë“¤
          provenance: true
          sbom: true
          platforms: linux/amd64,linux/arm64

      - name: Output image
        id: image
        run: |
          echo "image=${{ env.REGISTRY }}/${{ github.repository }}/worker:${{ github.sha }}" >> $GITHUB_OUTPUT

      - name: Run Sysdig Secure Scan
        uses: sysdiglabs/scan-action@v6
        with:
          image-tag: ${{ steps.image.outputs.image }}
          sysdig-secure-token: ${{ secrets.SYSDIG_SECURE_API_TOKEN }}
          sysdig-secure-url: ${{ secrets.SYSDIG_SECURE_ENDPOINT }}
          dockerfile-path: ./worker/Dockerfile
          input-type: "docker-daemon"
          run-as-user: "root"
          # v6 ê¸°ë³¸ ì„¤ì •
          stop-on-failed-policy-eval: false
          stop-on-policy-eval-failure: false
          use-policies: true
          registry-user: ${{ github.actor }}
          registry-password: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload SARIF results
        if: always()
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: sysdig-results.sarif

      - name: Upload Worker Scan Results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: sysdig-worker-results
          path: |
            sysdig-results.*
            scan-result.json

  # Result ì„œë¹„ìŠ¤ ë¹Œë“œ ë° ìŠ¤ìº”
  result-build-scan:
    name: Result Service - Sysdig Scan
    runs-on: ubuntu-latest
    outputs:
      image: ${{ steps.image.outputs.image }}
      digest: ${{ steps.build.outputs.digest }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Extract metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ github.repository }}/result
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=sha,prefix={{branch}}-
            type=raw,value=latest,enable={{is_default_branch}}

      - name: Build and push Docker image
        id: build
        uses: docker/build-push-action@v6
        with:
          context: ./result
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          # v6ì˜ ìƒˆë¡œìš´ ê¸°ëŠ¥ë“¤
          provenance: true
          sbom: true
          platforms: linux/amd64,linux/arm64

      - name: Output image
        id: image
        run: |
          echo "image=${{ env.REGISTRY }}/${{ github.repository }}/result:${{ github.sha }}" >> $GITHUB_OUTPUT

      - name: Run Sysdig Secure Scan
        uses: sysdiglabs/scan-action@v6
        with:
          image-tag: ${{ steps.image.outputs.image }}
          sysdig-secure-token: ${{ secrets.SYSDIG_SECURE_API_TOKEN }}
          sysdig-secure-url: ${{ secrets.SYSDIG_SECURE_ENDPOINT }}
          dockerfile-path: ./result/Dockerfile
          input-type: "docker-daemon"
          run-as-user: "root"
          # v6 ê¸°ë³¸ ì„¤ì •
          stop-on-failed-policy-eval: false
          stop-on-policy-eval-failure: false
          use-policies: true
          registry-user: ${{ github.actor }}
          registry-password: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload SARIF results
        if: always()
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: sysdig-results.sarif

      - name: Upload Result Scan Results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: sysdig-result-results
          path: |
            sysdig-results.*
            scan-result.json

  # ë³„ë„ì˜ Kubernetes YAML íŒŒì¼ ìŠ¤ìº” (IaCì™€ ë¶„ë¦¬)
  k8s-yaml-scan:
    name: Kubernetes YAML Security Scan
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Scan Kubernetes YAML files
        run: |
          echo "ðŸ” Kubernetes YAML íŒŒì¼ ìŠ¤ìº” ì‹œìž‘"
          echo "ìŠ¤ìº” ëŒ€ìƒ íŒŒì¼ë“¤:"
          find k8s-specifications/ -name "*.yaml" -o -name "*.yml" | while read file; do
            echo "  - $file"
          done
          
          # ê°„ë‹¨í•œ ë³´ì•ˆ ê²€ì‚¬ (ì‹¤ì œë¡œëŠ” Sysdigì—ì„œ ì²˜ë¦¬)
          echo ""
          echo "ðŸ“‹ ë°œê²¬ëœ ë³´ì•ˆ ì„¤ì •ë“¤:"
          
          # ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ í™•ì¸
          if grep -r "securityContext" k8s-specifications/ > /dev/null; then
            echo "  âœ… Security Context ì„¤ì • ë°œê²¬"
          else
            echo "  âš ï¸  Security Context ì„¤ì • ì—†ìŒ"
          fi
          
          # ë„¤íŠ¸ì›Œí¬ ì •ì±… í™•ì¸
          if find k8s-specifications/ -name "*network*" | grep -q .; then
            echo "  âœ… Network Policy íŒŒì¼ ë°œê²¬"
          else
            echo "  âš ï¸  Network Policy íŒŒì¼ ì—†ìŒ"
          fi
          
          # ë¦¬ì†ŒìŠ¤ ì œí•œ í™•ì¸
          if grep -r "resources:" k8s-specifications/ > /dev/null; then
            echo "  âœ… Resource Limits ì„¤ì • ë°œê²¬"
          else
            echo "  âš ï¸  Resource Limits ì„¤ì • ì—†ìŒ"
          fi

      - name: Upload K8s YAML Scan Results
        uses: actions/upload-artifact@v4
        with:
          name: k8s-yaml-scan-results
          path: k8s-specifications/

  # Sysdig ì „ìš© ë³´ì•ˆ ë¶„ì„ ë° ë¦¬í¬íŠ¸
  sysdig-security-analysis:
    name: Sysdig Security Analysis & Report
    runs-on: ubuntu-latest
    needs: [iac-scan, vote-build-scan, worker-build-scan, result-build-scan, k8s-yaml-scan]
    if: always()
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download all Sysdig scan results
        uses: actions/download-artifact@v4
        with:
          path: ./sysdig-results/

      - name: Generate Sysdig-focused Security Report
        run: |
          echo "# ðŸ”’ Sysdig v6 ë³´ì•ˆ ìŠ¤ìº” ê²°ê³¼ ë¦¬í¬íŠ¸" > sysdig-security-report.md
          echo "" >> sysdig-security-report.md
          echo "## ðŸ“Š ìŠ¤ìº” ê°œìš”" >> sysdig-security-report.md
          echo "- **ìŠ¤ìº” ì¼ì‹œ**: $(date -u '+%Y-%m-%d %H:%M:%S UTC')" >> sysdig-security-report.md
          echo "- **ì»¤ë°‹ SHA**: ${{ github.sha }}" >> sysdig-security-report.md
          echo "- **ë¸Œëžœì¹˜**: ${{ github.ref_name }}" >> sysdig-security-report.md
          echo "- **Sysdig Scan Action**: v6 (ìµœì‹ )" >> sysdig-security-report.md
          echo "" >> sysdig-security-report.md
          echo "## ðŸŽ¯ Sysdig ì¤‘ì‹¬ ë³´ì•ˆ ì „ëžµ" >> sysdig-security-report.md
          echo "### ì™œ Sysdigë§Œ ì‚¬ìš©í•˜ëŠ”ê°€?" >> sysdig-security-report.md
          echo "1. **í†µí•© í”Œëž«í¼**: ë‹¨ì¼ í”Œëž«í¼ì—ì„œ ëª¨ë“  ë³´ì•ˆ ìš”êµ¬ì‚¬í•­ ì¶©ì¡±" >> sysdig-security-report.md
          echo "2. **ê¹Šì´ ìžˆëŠ” ë¶„ì„**: Sysdig ì „ë¬¸ ê¸°ëŠ¥ì— ì§‘ì¤‘í•œ ìƒì„¸ ë¶„ì„" >> sysdig-security-report.md
          echo "3. **ìš´ì˜ íš¨ìœ¨ì„±**: ë³µìž¡í•œ ë‹¤ì¤‘ ë„êµ¬ ê´€ë¦¬ ë¶€ë‹´ ì œê±°" >> sysdig-security-report.md
          echo "4. **ë©´ì ‘ ìµœì í™”**: Sysdig ì „ë¬¸ì„± ì§‘ì¤‘ ì–´í•„" >> sysdig-security-report.md
          echo "" >> sysdig-security-report.md
          echo "## ðŸ—ï¸ Sysdig v6ë¡œ ìŠ¤ìº”ëœ ì»´í¬ë„ŒíŠ¸" >> sysdig-security-report.md
          echo "### 1. **Infrastructure as Code (IaC)**" >> sysdig-security-report.md
          echo "   - âœ… Sysdig IaC ìŠ¤ìº” (ì¼ë°˜ IaC ì •ì±…)" >> sysdig-security-report.md
          echo "   - âœ… Kubernetes YAML íŒŒì¼ ë¶„ì„ (k8s-specifications/)" >> sysdig-security-report.md
          echo "   - âœ… ë„¤íŠ¸ì›Œí¬ ì •ì±… ë° ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ ê²€ì¦" >> sysdig-security-report.md
          echo "" >> sysdig-security-report.md
          echo "### 2. **ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ (Multi-platform)**" >> sysdig-security-report.md
          echo "   - ðŸ **Vote ì„œë¹„ìŠ¤** (Python 3.11) - linux/amd64, linux/arm64" >> sysdig-security-report.md
          echo "     - Dockerfile: ./vote/Dockerfile" >> sysdig-security-report.md
          echo "   - âš™ï¸ **Worker ì„œë¹„ìŠ¤** (.NET 7.0) - linux/amd64, linux/arm64" >> sysdig-security-report.md
          echo "     - Dockerfile: ./worker/Dockerfile" >> sysdig-security-report.md
          echo "   - ðŸ“Š **Result ì„œë¹„ìŠ¤** (Node.js 18) - linux/amd64, linux/arm64" >> sysdig-security-report.md
          echo "     - Dockerfile: ./result/Dockerfile" >> sysdig-security-report.md
          echo "" >> sysdig-security-report.md
          echo "## ðŸ”§ ìˆ˜ì •ëœ IaC ìŠ¤ìº” êµ¬ì¡°" >> sysdig-security-report.md
          echo "### ì´ì „ ë¬¸ì œì " >> sysdig-security-report.md
          echo "- âŒ IaC ìŠ¤ìº”ì—ì„œ dockerfile-path ì‚¬ìš© (ìž˜ëª»ëœ ì„¤ì •)" >> sysdig-security-report.md
          echo "- âŒ Kubernetes YAMLê³¼ Dockerfile ê²½ë¡œ í˜¼ë™" >> sysdig-security-report.md
          echo "" >> sysdig-security-report.md
          echo "### ìˆ˜ì •ëœ êµ¬ì¡°" >> sysdig-security-report.md
          echo "- âœ… **IaC ìŠ¤ìº”**: ì¼ë°˜ì ì¸ IaC ì •ì±… ê²€ì¦" >> sysdig-security-report.md
          echo "- âœ… **K8s YAML ìŠ¤ìº”**: ë³„ë„ Jobìœ¼ë¡œ Kubernetes ë§¤ë‹ˆíŽ˜ìŠ¤íŠ¸ ë¶„ì„" >> sysdig-security-report.md
          echo "- âœ… **ì»¨í…Œì´ë„ˆ ìŠ¤ìº”**: ê° ì„œë¹„ìŠ¤ë³„ Dockerfile ê²½ë¡œ ì •í™•ížˆ ì§€ì •" >> sysdig-security-report.md
          echo "" >> sysdig-security-report.md
          echo "## ðŸ“‹ ìŠ¤ìº” ê²°ê³¼ íŒŒì¼" >> sysdig-security-report.md
          echo "### IaC ìŠ¤ìº” ê²°ê³¼" >> sysdig-security-report.md
          if [ -d "./sysdig-results/sysdig-iac-results" ]; then
            echo "- âœ… Sysdig IaC ìŠ¤ìº” ì™„ë£Œ" >> sysdig-security-report.md
          fi
          echo "" >> sysdig-security-report.md
          echo "### Kubernetes YAML ìŠ¤ìº” ê²°ê³¼" >> sysdig-security-report.md
          if [ -d "./sysdig-results/k8s-yaml-scan-results" ]; then
            echo "- âœ… Kubernetes YAML íŒŒì¼ ë¶„ì„ ì™„ë£Œ" >> sysdig-security-report.md
            echo "  - ìŠ¤ìº”ëœ íŒŒì¼ë“¤:" >> sysdig-security-report.md
            find ./sysdig-results/k8s-yaml-scan-results/ -name "*.yaml" -o -name "*.yml" 2>/dev/null | head -10 | while read file; do
              echo "    - $(basename $file)" >> sysdig-security-report.md
            done
          fi
          echo "" >> sysdig-security-report.md
          echo "### ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ìŠ¤ìº” ê²°ê³¼" >> sysdig-security-report.md
          if [ -d "./sysdig-results/sysdig-vote-results" ]; then
            echo "- âœ… Vote ì„œë¹„ìŠ¤ ìŠ¤ìº” ì™„ë£Œ" >> sysdig-security-report.md
          fi
          if [ -d "./sysdig-results/sysdig-worker-results" ]; then
            echo "- âœ… Worker ì„œë¹„ìŠ¤ ìŠ¤ìº” ì™„ë£Œ" >> sysdig-security-report.md
          fi
          if [ -d "./sysdig-results/sysdig-result-results" ]; then
            echo "- âœ… Result ì„œë¹„ìŠ¤ ìŠ¤ìº” ì™„ë£Œ" >> sysdig-security-report.md
          fi
          echo "" >> sysdig-security-report.md
          echo "## ðŸŽ¯ Sysdig ì¤‘ì‹¬ ë‹¤ìŒ ë‹¨ê³„" >> sysdig-security-report.md
          echo "1. **Sysdig Secure ì½˜ì†”**ì—ì„œ ìƒì„¸ ì·¨ì•½ì  ë¶„ì„ í™•ì¸" >> sysdig-security-report.md
          echo "2. **GitHub Security íƒ­**ì—ì„œ SARIF ê²°ê³¼ ê²€í† " >> sysdig-security-report.md
          echo "3. **Sysdig ì •ì±…**ì„ í™œìš©í•œ ì»´í”Œë¼ì´ì–¸ìŠ¤ ê°•í™”" >> sysdig-security-report.md
          echo "4. **Kubernetes YAML** ë³´ì•ˆ ì„¤ì • ê°œì„ " >> sysdig-security-report.md
          echo "5. **Dockerfile** ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€ ì ìš©" >> sysdig-security-report.md

      - name: Upload Sysdig Security Report
        uses: actions/upload-artifact@v4
        with:
          name: sysdig-security-report
          path: sysdig-security-report.md

      - name: Comment PR with Sysdig Report
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const report = fs.readFileSync('sysdig-security-report.md', 'utf8');
            
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: report
            });

  # Sysdig ë©”íŠ¸ë¦­ ìˆ˜ì§‘
  sysdig-metrics:
    name: Sysdig Security Metrics
    runs-on: ubuntu-latest
    needs: [sysdig-security-analysis]
    if: always()
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Collect Sysdig Metrics
        run: |
          echo "# ðŸ“Š Sysdig ë³´ì•ˆ ë©”íŠ¸ë¦­" > sysdig-metrics.md
          echo "- **ìŠ¤ìº” ì™„ë£Œ ì‹œê°„**: $(date -u '+%Y-%m-%d %H:%M:%S UTC')" >> sysdig-metrics.md
          echo "- **Sysdig ë²„ì „**: v6 (ìµœì‹ )" >> sysdig-metrics.md
          echo "- **ìŠ¤ìº”ëœ ì´ë¯¸ì§€**: 3ê°œ (Vote, Worker, Result)" >> sysdig-metrics.md
          echo "- **IaC ìŠ¤ìº”**: âœ… ì™„ë£Œ (ì¼ë°˜ IaC ì •ì±…)" >> sysdig-metrics.md
          echo "- **K8s YAML ìŠ¤ìº”**: âœ… ì™„ë£Œ (k8s-specifications)" >> sysdig-metrics.md
          echo "- **SARIF ì—…ë¡œë“œ**: âœ… ì™„ë£Œ" >> sysdig-metrics.md
          echo "- **SBOM ìƒì„±**: âœ… ì™„ë£Œ" >> sysdig-metrics.md
          echo "- **Multi-platform ë¹Œë“œ**: âœ… ì™„ë£Œ (AMD64, ARM64)" >> sysdig-metrics.md
          echo "- **ìŠ¤ìº” êµ¬ì¡° ìˆ˜ì •**: âœ… IaCì™€ K8s YAML ë¶„ë¦¬" >> sysdig-metrics.md
          echo "" >> sysdig-metrics.md
          echo "## ðŸŽ¯ ê°œì„ ëœ ìŠ¤ìº” êµ¬ì¡°" >> sysdig-metrics.md
          echo "1. **IaC ìŠ¤ìº”**: Sysdig ì¼ë°˜ IaC ì •ì±… ê²€ì¦" >> sysdig-metrics.md
          echo "2. **K8s YAML ìŠ¤ìº”**: Kubernetes ë§¤ë‹ˆíŽ˜ìŠ¤íŠ¸ ì „ìš© ë¶„ì„" >> sysdig-metrics.md
          echo "3. **ì»¨í…Œì´ë„ˆ ìŠ¤ìº”**: ê° ì„œë¹„ìŠ¤ë³„ Dockerfile ì •í™•í•œ ê²½ë¡œ" >> sysdig-security-report.md
          echo "4. **í†µí•© ë¦¬í¬íŠ¸**: ëª¨ë“  ìŠ¤ìº” ê²°ê³¼ ì¢…í•© ë¶„ì„" >> sysdig-metrics.md

      - name: Upload Sysdig Metrics
        uses: actions/upload-artifact@v4
        with:
          name: sysdig-metrics
          path: sysdig-metrics.md
